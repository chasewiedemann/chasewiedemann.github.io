---
title: "Replication"
output: html_document
---
```{r,echo = F}
base_dir = getwd()
base_url = paste0("https://",substr(base_dir,8, nchar(base_dir)))
wp_link = paste0(base_url,"/WorkingPaper.html")
ws_link = paste0(base_url,"/WorkingSlides.html")
rep_link = paste0(base_url,"/Replication.html")
miniblog_link = paste0(base_url,"/MiniBlog.html")
```

[Home](https://chasewiedemann.github.io/index.html) |
[About](https://chasewiedemann.github.io/Site/about.html) |
[Projects](https://chasewiedemann.github.io/Site/Projects/projects.html) |
[Paper Summaries](https://chasewiedemann.github.io/Site/Summaries/summaries.html) |
[Blog](https://chasewiedemann.github.io/Site/blog.html) |

[Working Paper](`r wp_link`)|
[Working Slides](`r ws_link`)|
[Replication](`r rep_link`)|
[Mini-Blog](`r miniblog_link`)|

```{r}
library(censusapi)
```

# Introduction

When working in Urban Economics, we unsurprising focus on Urban areas. But what is an Urban area? We tend to take this as some predefined object, such as a MSA, a group of countys, or whatever level of data that we have. The goal of this paper is to let the data identify what an Urban Area should be, and really to go beyond that. 

For a long time, and still somewhat currently, the workhorse model of urban economics was the Alonzo-Mills-Muth Model of the Central Business District (CBD). What that theory says is that all urban areas are built around CBD's which are historically the major city that has been around the longest. So the St. Louis CBD would be centered by the city of St. Louis and the surrounding area would fall into the urbn area around that CBD. 

What do CBD's do? Well they produce. A standard model would have the assumption that all people living in the urban area work in the CBD. These workers can only access utility through working in the CBD (Maybe you normalize the utility of work outside the CBD to zero). A common assumption would also be that workers are symmetric, so that they all have to get the same utility. 

# Model and Identification

I think I need to be talking about the model in terms of the Census's Business Register, instead of what we observe as the zipcode. So the model is based on each firms decisions, but we only observe this statistic about the groupings in a zipcode. That should help clarify what assumptions we are making that are solely a function of not having the business registrar data.




# Data

We are going to be using the County Business Patterns Zipcode Files for this project. These are basically a summary statistic of the Business Registar at the zipcode level. The Business Registar has the data on every business that is registered with the IRS. So its about as good as your are gonna get. Our model is in terms of that, and our econometric strategy requires additional assumptions to use the zipcode level. But enough about things that are eventually gonna be moved out of this section and onto the data.

We are gonna be using the census api to get this done. The website that its hosted at is 

https://www.census.gov/data/developers/data-sets/cbp-zbp/cbp-api.html

Were gonna try using the `censusapi` R package. I'm following a tutorial I found that can be accessed at

https://www.hrecht.com/censusapi/articles/getting-started.html

I first need to get a key. That is done through the following link

https://api.census.gov/data/key_signup.html

I got a key, it came in an email. Below is a non-echoed R chunk that assigns my key to the variable `MY_CENSUS_KEY` and then I have `Sys.setenv(CENSUS_KEY=MY_CENSUS_KEY)`

```{r,echo = F}
MY_CENSUS_KEY = "c161ed0f016172a3598940df9853fe128705043e"
Sys.setenv(CENSUS_KEY=MY_CENSUS_KEY)
```

I wouldn't really mind if you use my key. But Ill keep it private. But back to work. Heres code taken from the tutorial just to make sure it works on my end


```{r}
sahie_counties <- getCensus(
    name = "timeseries/healthins/sahie",
    vars = c("NAME", "PCTUI_PT", "NUI_PT"), 
    region = "county:*", 
    time = 2021)
head(sahie_counties)
```
Beautiful. Lets start changing it to what we need

We can get the list of apis available by running

```{r}


```





